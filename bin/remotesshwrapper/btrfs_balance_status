#!/usr/bin/env perl
use Data::Dumper;
use JSON;

my $mount_arg = $ARGV[0];

my @mounts = split('#', $mount_arg);

my %balance_status;
foreach my $mount ( @mounts ) {
#    print "Hossa: $mount\n";
    my $output = `/sbin/btrfs balance status $mount`;
#       print "BTRFS: $output\n";
    $balance_status{$mount} = {
        'output' => $output,
    };
}

my $json = JSON->new->allow_nonref;
my $json_text = $json->encode(\%balance_status);
print "$json_text";
